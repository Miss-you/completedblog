#IPVS负载均衡（一）基本概念


> ipvs是指IP虚拟服务器（IP Virtual Server，简写为**IPVS**）

##IPVS含义

IPVS是一个高效的Layer-4交换机`（单来说就是以源目标IP地址-层3、源目标端口-层4，所以叫Layer-4）`，它提供负载平衡的功能。

##工作基本流程

这里拿TCP链路负载均衡举例

`实际上现在IPVS开源版本支持TCP/UDP/SCTP层4协议的负载均衡`

1. 当一个新的TCP连接的初始SYN报文到达IPVS时，IPVS就选择一台挂载在IPVS上的服务器，将报文转发给他，并且记录该连接的建立连接状态。`包括源目标IP地址、报文协议类型、源目标端口、连接状态`
2. 此后，再次到来的来自同一IP地址+端口号的TCP报文，IPVS服务器就会查询之前记录的连接状态，将其负载均衡到和之前相同的服务器上。

###题外话
这样话其实就有弊端，弊端在于IPVS对于后续的报文是不对其进行内容检查，所以必须要求IPVS后挂载的服务器需要提供相同的服务：不管请求发送到哪个服务器，返回结果应当都是一样的；或者在应用层做好相应的同步、或者集群内服务器信息交互

直接这么说可能有些容易让人迷惑，实际上IPVS是LVS的一个子项目，所以先整体介绍一下LVS的通用结构，那么应该就会容易让人理解一些。









